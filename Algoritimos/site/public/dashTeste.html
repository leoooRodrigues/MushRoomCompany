<!DOCTYPE html>
<html lang="pt_br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/css/dash_cssV1.css">
    <link rel="stylesheet" href="assets/css/header.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="http://www.chartjs.org/dist/2.7.1/Chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


    <link rel="shortcut icon" type="imagex/png" href="../SiteInstitucional_Juntando/assets/img/Logo_SEM ESCRITA.png">

    <title>MushRoom.co</title>
    <style>
    </style>
</head>

<body>
    <div class="header">
        <div class="containerHeader">

            <h1 class="logo"><a href="index.html">MUSHROOM.co</a></h1>

            <div class="navbar">
                <ul>
                    <li><a class="linha_baixo" href="index.html">HOME</li>
                    <li><a class="linha_baixo" href="index.html#pg4">SOBRE NÓS</a></li>
                    <li><a class="linha_baixo" href="CalculadoraFinal.html">CALCULADORA FINANCEIRA</a></li>
                    <li id="dashUser"><a class="linha_baixo" href="dashV1.html">DASHBOARD</a></li>
                    <li id="sairUser"><button onclick="limparSessao()"><b>SAIR</b></button></li>
                    <!-- <li id="sairUser"><b class="linha_baixo"  href="#"  onclick="limparSessao()">SAIR</a></li> -->
                    <li><button onclick="aparecerLogin()" id="btnUser"><b>LOGIN</b></button></li>
                </ul>
            </div>
        </div>
        <div class="cadbar" id="cadbar">
            <div class="cadbarInput">
                <span>CNPJ</span>
                <input type="text" class="inpsbege">
            </div>



            <div class="cadbarInput">
                <span>SENHA</span>
                <input type="password" class="inpsbege">
            </div>
            <button><B>ENTRAR</B></button>

            <u><a href="cadastro.html">Não tem conta ? Cadastre-se !</a></u>
        </div>
    </div>
    <!-- fim header -->
    <div class="ajuda"><button class="buttonAjuda">Suporte</button></div>
    <div class="main">
        <div class="inpts_dash" id="inpts_dash">
            <div class="abridor" onclick="abrir()">| | |</div>
            <div class="sidebar">
                <h3>Setores</h3>
                <!--  <a href="#">setor 1</a>
                <a href="#">setor 2</a>
                <a href="#">setor 3</a>
                <a href="#">setor 4</a>
                <a href="#">setor 5</a>
                <a href="#">setor 6</a> -->
                <div class="select">
                    <select id="slcSetor" class="inpt">
                        <option class="opcao1" value="1">setor 1</option>
                        <option class="opcao2" value="2">setor 2</option>
                        <!-- <option class="opcao3" value="3">setor 3</option>
                      <option class="opcao4" value="4">setor 4</option> -->
                    </select>
                </div> <br>
                <button class="botao" onclick="setor()">Ver setor</button>
                <br>
                <div class="separador"></div>


                <div class="select" style="margin-top: 20px;">
                    <select id="slcFaseCogu" class="inpt">
                        <option class="opcao1" value="1">Inoculação</option>
                        <option class="opcao2" value="2">Colonização</option>
                        <option class="opcao2" value="3">desenvolvimento</option>
                        <!-- <option class="opcao3" value="3">setor 3</option>
                      <option class="opcao4" value="4">setor 4</option> -->
                    </select>
                </div> <br>

                <button id="btnConfirmar" class="btnMostrar" onclick="confirmar()">Confirmar</button>
                <!-- <input type="number" id="inpt_mudar"><br> -->
                <!-- <button onclick="mudarParametros()">Mudar</button> -->
                <div id="divMostrar" class="divMostrar" style="display: none;">
                    <div class=" inps_limitador">
                        umidade ideal minima:
                        <input type="number" id="inp_umi_min" class="inpsbege">
                    </div>
                    <div class="inps_limitador">
                        umidade ideal maxima:
                        <input type="number" id="inp_umi_max" class="inpsbege">
                    </div>
                    <div class="inps_limitador">
                        temperatura ideal minima:
                        <input type="number" id="inp_temp_min" class="inpsbege">
                    </div>
                    <div class="inps_limitador">
                        temperatura ideal maxima:
                        <input type="number" id="inp_temp_max" class="inpsbege">
                    </div>
                    <button id="btnConfirmar" class="btnMostrar" onclick="confirmar()">Confirmar</button>
                </div>
                <button id="btnMostrar" class="btnMostrar" onclick="habilitar()" style="display: flex; ">Mudar
                    Parametros</button>
            </div>

        </div>
        <div class="content" id="content">

            <div class="conteudo" id="str1">
                <div class="infosSensores">
                    <div class="cardsDash">
                        <h3>Ultimos valores Resgatados</h3>
                        <div class="cardInformacoes">
                            <div class="cardMetricas">
                                <img src="assets/img/sensor-de-temperatura.png" alt="" class="imgMetricas">
                                <div class="metricasInfo">
                                    <h2><span id="MetricasInfoTemp">22.6</span>ºC</h2>
                                </div>
                            </div>
                            <div class="cardMetricas">
                                <img src="assets/img/umidade.png" alt="" class="imgMetricas">
                                <div class="metricasInfo">
                                    <h2><span id="MetricasInfoUmi">85</span>%</h2>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="cardsDash cd2">
                        <div class="cardsSeparacao">
                            <div>
                                <h4>Temperatura Min ideal:</h4>
                                <h4><span id="vlr_Temp_min">15</span>°C</h4>
                            </div>
                            <div>
                                <h4>Umidade Min ideal:</h4>
                                <h4><span id="vlr_Umi_min">85</span>%</h4>
                            </div>
                        </div> <!-- fim box1 -->
                        <div class="separador"></div>
                        <div class="cardsSeparacao">
                            <div>
                                <h4>Temperatura Max ideal:</h4>
                                <h4><span id="vlr_Temp_max">21</span>°C</h4>
                            </div>
                            <div>
                                <h4>Umidade Max ideal:</h4>
                                <h4><span id="vlr_Umi_max">90</span>%</h4>
                            </div>
                        </div><!-- fim box2 -->
                    </div>
                    <div class="cardsDash">
                        <div class="box-ideal">
                            <div id="temp" class="ideal temp">Temperatura - Ideal</div>
                            <div id="umi" class="ideal umi">Umidade - Ideal</div>
                        </div> <!-- fim box2 -->
                    </div>
                </div>
                <div class="divGraficos">
                    <h2 style="color: black;">Setor 1</h2>
                    <!-- <div class="Sensor"> -->
                    <div class="canva">
                        <div class="graf-conteudo">
                            <canvas id="myChartLinhaTemp1" class="cnvs"></canvas>
                        </div>

                        <div class="graf-conteudo doughnut">
                            <h1>Temperatura do Dia</h1>
                            <canvas id="myChartdoughnutTemp1" class="cnvs"></canvas>
                        </div>


                    </div>
                    <div class="canva">

                        <div class="graf-conteudo">
                            <canvas id="myChartLinhaUmi1" class="cnvs"></canvas>
                        </div>

                        <div class="graf-conteudo doughnut">
                            <h1>Umidade do Dia</h1>
                            <canvas id="myChartdoughnutUmi1" class="cnvs"></canvas>
                        </div>
                        <!--                             
                            <div class="graf-conteudo doughnut">
                                <canvas id="myChart4" class="cnvs"></canvas>
                            </div> -->
                    </div>
                    <!-- </div> -->
                </div>
            </div>


            <!-- <div class="conteudo" id="str2" style="display: none;">
                <div class="infosSensores">
                    <div class="cardsDash">
                        <h3>Ultimos valores Resgatados</h3>
                        <div class="cardInformacoes">
                            <div class="cardMetricas">
                                <img src="assets/img/sensor-de-temperatura.png" alt="" class="imgMetricas">
                                <div class="metricasInfo">
                                    <h2>22.6ºC</h2>
                                </div>
                            </div>
                            <div class="cardMetricas">
                                <img src="assets/img/umidade.png" alt="" class="imgMetricas">
                                <div class="metricasInfo">
                                    <h2>85%</h2>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="cardsDash cd2">
                        <div class="cardsSeparacao">
                            <div>
                                <h4>Temperatura Min ideal:</h4>
                                <h4><span id="vlr_Temp_min">15</span>°C</h4>
                            </div>
                            <div>
                                <h4>Umidade Min ideal:</h4>
                                <h4><span id="vlr_Umi_min">85</span>%</h4>
                            </div>
                        </div> <!-- fim box1 
                        <div class="separador"></div>
                        <div class="cardsSeparacao">
                            <div>
                                <h4>Temperatura Max ideal:</h4>
                                <h4><span id="vlr_Temp_max">21</span>°C</h4>
                            </div>
                            <div>
                                <h4>Umidade Max ideal:</h4>
                                <h4><span id="vlr_Umi_max">90</span>% </h4>
                            </div>
                        </div><!-- fim box2 
                    </div>
                    <div class="cardsDash">
                        <div class="box-ideal">
                            <div id="temp" class="ideal temp">Temperatura Ideal</div>
                            <div id="umi" class="ideal umi">Umidade Ideal</div>
                        </div>
                    </div>

                </div>
                <div class="divGraficos">
                    <h2 style="color: black;">Setor 2</h2>
                    <!-- <div class="Sensor"> 
                    <div class="canva">
                        <div class="graf-conteudo">
                            <canvas id="myChartLinhaTemp2" class="cnvs"></canvas>
                        </div>

                        <div class="graf-conteudo doughnut">
                            <canvas id="myChartdoughnutTemp2" class="cnvs"></canvas>
                        </div>


                    </div>
                    <div class="canva">

                        <div class="graf-conteudo">
                            <canvas id="myChartLinhaUmi2" class="cnvs"></canvas>
                        </div>

                        <div class="graf-conteudo doughnut">
                            <canvas id="myChartdoughnutUmi2" class="cnvs"></canvas>
                        </div>
                        <!--                             
                            <div class="graf-conteudo doughnut">
                                <canvas id="myChart4" class="cnvs"></canvas>
                            </div> 
                    </div>
                    <!-- </div> 
                </div>
            </div> -->

        </div>
    </div>
</body>

</html>

<script>

    window.onload = obterDadosGrafico();
    // window.onload = plotarGrafico();
    // window.onload = plotarGrafico1();

    function abrir() {
        if (inpts_dash.style.width == '15%') {
            inpts_dash.style.width = '0px'
            content.style.width = '100%'
        } else {
            inpts_dash.style.width = '15%'
            content.style.width = '85%'
        }
    }

    if (sessionStorage.logado == 1) {
        dashUser.style.display = 'block'
        btnUser.style.display = 'none'
        sairUser.style.display = 'block'
    }
    else {
        dashUser.style.display = 'none'
        btnUser.style.display = 'block'
        sairUser.style.display = 'none'
    }
    // grafico 1
    // var umiMin = 70
    // var umiMax = 100
    // var TempMin = 15
    // var TempMax = 25
    // var vlrsGraficoUmi = [70, 81, 82, 78, 80, 79, 70, 81, 82, 78, 80, 79, 70, 81, 82, 78, 80, 79]
    // var vlrsGraficoTemp = [28, 25, 19, 17, 24, 20, 28, 25, 19, 17, 24, 20, 28, 25, 19, 17, 24, 20,]

    var sector = 1;
    sector = Number(slcSetor.value)
    console.log(sector, "valor do setor")

    function obterDadosGrafico(sector) {

        // alterarTitulo(sector)

        // if (proximaAtualizacao != undefined) {
        //     clearTimeout(proximaAtualizacao);
        // }

        fetch(`/medidas/ultimas/${sector}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                    resposta.reverse();

                    plotarGrafico(resposta);
                    plotarGrafico1(resposta);

                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    function plotarGrafico(resposta) {
        console.log(resposta);

        console.log(' entrou no plotar, iniciando plotagem do gráfico...');
        console.log(resposta[0].temperatura, 'era p ser temperatura')

        // Criando estrutura para plotar gráfico - labels
        let labels = [];
        let data = [];

        // Criando estrutura para plotar gráfico - dados
        let dados = {
            labels: labels,
            datasets: [{
                //     label: 'Umidade',
                //     data: [],
                //     fill: false,
                //     borderColor: 'rgb(75, 192, 192)',
                //     tension: 0.1
                // },
                // {
                label: 'Temperatura',
                data: [],
                fill: false,
                borderColor: 'rgb(199, 52, 52)',
                backgroundColor: ('#00000000'),
                borderColor: ('#ff0000'),
                tension: 0.1
            }]
        };

        console.log('----------------------------------------------')
        console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
        console.log(resposta)

        // Inserindo valores recebidos em estrutura para plotar o gráfico
        for (i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            labels.push(registro.momento_grafico);
            // dados.datasets[0].data.push(registro.umidade);
            dados.datasets[0].data.push(registro.temperatura);
        }

        console.log('----------------------------------------------')
        console.log('O gráfico será plotado com os respectivos valores:')
        console.log('Labels:')
        console.log(labels)
        console.log('Dados:')
        console.log(dados.datasets)
        console.log('----------------------------------------------')

        // Criando estrutura para plotar gráfico - config
        const config = {
            type: 'line',
            data: dados,
        };

        // Adicionando gráfico criado em div na tela
        let myChart = new Chart(
            document.getElementById(`myChartLinhaTemp1`),
            config
        );

        setTimeout(() => atualizarGrafico(sector, dados, myChart), 2000);
    }


    function atualizarGrafico(sector, dados, myChart) {


        console.log(sector);
        fetch(`/medidas/tempo-real/${sector}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (novoRegistro) {

                    // obterdados(sector);
                    // alertar(novoRegistro, sector);
                    console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
                    console.log(`Dados atuais do gráfico:`);
                    console.log(dados);

                    // let avisoCaptura = document.getElementById(`avisoCaptura${sector}`)
                    // avisoCaptura.innerHTML = ""


                    if (novoRegistro[0].momento_grafico == dados.labels[dados.labels.length - 1]) {
                        console.log("---------------------------------------------------------------")
                        console.log("Como não há dados novos para captura, o gráfico não atualizará.")
                        avisoCaptura.innerHTML = "<i class='fa-solid fa-triangle-exclamation'></i> Foi trazido o dado mais atual capturado pelo sensor. <br> Como não há dados novos a exibir, o gráfico não atualizará."
                        console.log("Horário do novo dado capturado:")
                        console.log(novoRegistro[0].momento_grafico)
                        console.log("Horário do último dado capturado:")
                        console.log(dados.labels[dados.labels.length - 1])
                        console.log("---------------------------------------------------------------")
                    } else {
                        // tirando e colocando valores no gráfico
                        dados.labels.shift(); // apagar o primeiro
                        dados.labels.push(parseInt(novoRegistro[0].momento_grafico)); // incluir um novo momento

                        // dados.datasets[0].data.shift();  
                        // apagar o primeiro de umidade
                        // dados.datasets[0].data.push(novoRegistro[0].umidade); 
                        // incluir uma nova medida de umidade
                        var TempAtual = novoRegistro[0].temperatura
                        TempAtual -= 10

                        dados.datasets[0].data.shift();  // apagar o primeiro de temperatura
                        dados.datasets[0].data.push(TempAtual);
                        MetricasInfoTemp.innerHTML = TempAtual; // incluir uma nova medida de temperatura

                        var alerta = document.getElementById('temp');
                        var vlrTempMax = Number(document.getElementById('vlr_Temp_max').innerText);
                        var vlrTempMin = Number(document.getElementById('vlr_Temp_min').innerText);
                        // alert(TempAtual)
                        if (TempAtual > (vlrTempMax + 4) || TempAtual < (vlrTempMin - 4)) {
                            alerta.style.backgroundColor = '#ff0000 '
                            temp.innerHTML = `Temperatura - Crítica`;
                        } else if (TempAtual > (vlrTempMax + 2) || TempAtual < (vlrTempMin - 2)) {
                            alerta.style.backgroundColor = '#ffa500 '
                            temp.innerHTML = `Temperatura - Emergencia`;
                        } else if (TempAtual > vlrTempMax || TempAtual < vlrTempMin) {
                            alerta.style.backgroundColor = '#ff0'
                            temp.innerHTML = `Temperatura - Alerta`;
                        } else {
                            alerta.style.backgroundColor = '#0f0'
                            temp.innerHTML = `Temperatura - Ideal`;
                        }


                        myChart.update();
                    }

                    // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                    proximaAtualizacao = setTimeout(() => atualizarGrafico(sector, dados, myChart), 2000);
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
                // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                proximaAtualizacao = setTimeout(() => atualizarGrafico(sector, dados, myChart), 2000);
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });


        // grafico dois de umidade



    }



    //    grafico 2 de umidade


    function plotarGrafico1(resposta) {

        console.log(' entrou no plotar, iniciando plotagem do gráfico...');
        console.log(resposta[0].umidade, 'era p ser umidade')

        // Criando estrutura para plotar gráfico - labels
        let labels = [];
        let data = [];

        // Criando estrutura para plotar gráfico - dados
        let dados = {
            labels: labels,
            datasets: [{
                //     label: 'Umidade',
                //     data: [],
                //     fill: false,
                //     borderColor: 'rgb(75, 192, 192)',
                //     tension: 0.1
                // },
                // {
                label: 'Umidade',
                data: [],
                fill: false,
                borderColor: 'rgb(75, 192, 192)',
                backgroundColor: ('#00000000'),
                borderColor: ('blue'),
                tension: 0.1
            }]
        };

        console.log('----------------------------------------------')
        console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
        console.log(resposta)

        // Inserindo valores recebidos em estrutura para plotar o gráfico
        for (i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            labels.push(registro.momento_grafico);
            // dados.datasets[0].data.push(registro.umidade);
            dados.datasets[0].data.push(registro.umidade);
        }

        console.log('----------------------------------------------')
        console.log('O gráfico será plotado com os respectivos valores:')
        console.log('Labels:')
        console.log(labels)
        console.log('Dados:')
        console.log(dados.datasets)
        console.log('----------------------------------------------')

        // Criando estrutura para plotar gráfico - config
        const config = {
            type: 'line',
            data: dados,
        };

        // Adicionando gráfico criado em div na tela
        let myChart = new Chart(
            document.getElementById(`myChartLinhaUmi1`),
            config
        );

        setTimeout(() => atualizarGrafico1(sector, dados, myChart), 2000);
    }


    function atualizarGrafico1(sector, dados, myChart) {



        fetch(`/medidas/tempo-real/${sector}`, { cache: 'no-store' }).then(function (response) {
            if (response.ok) {
                response.json().then(function (novoRegistro) {

                    // obterdados(sector);
                    // alertar(novoRegistro, sector);
                    console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
                    console.log(`Dados atuais do gráfico:`);
                    console.log(dados);

                    // let avisoCaptura = document.getElementById(`avisoCaptura${sector}`)
                    // avisoCaptura.innerHTML = ""


                    if (novoRegistro[0].momento_grafico == dados.labels[dados.labels.length - 1]) {
                        console.log("---------------------------------------------------------------")
                        console.log("Como não há dados novos para captura, o gráfico não atualizará.")
                        avisoCaptura.innerHTML = "<i class='fa-solid fa-triangle-exclamation'></i> Foi trazido o dado mais atual capturado pelo sensor. <br> Como não há dados novos a exibir, o gráfico não atualizará."
                        console.log("Horário do novo dado capturado:")
                        console.log(novoRegistro[0].momento_grafico)
                        console.log("Horário do último dado capturado:")
                        console.log(dados.labels[dados.labels.length - 1])
                        console.log("---------------------------------------------------------------")
                    } else {
                        // tirando e colocando valores no gráfico
                        dados.labels.shift(); // apagar o primeiro
                        dados.labels.push(parseInt(novoRegistro[0].momento_grafico)); // incluir um novo momento

                        dados.datasets[0].data.shift();
                        // apagar o primeiro de umidade
                        var UmiAtual = novoRegistro[0].umidade;
                        UmiAtual += 20
                        dados.datasets[0].data.push(UmiAtual);
                        MetricasInfoUmi.innerHTML = UmiAtual; // incluir uma nova medida de temperatura
                        alerta = document.getElementById('umi');
                        alerta = document.getElementById('umi');
                        // alert(UmiAtual);
                        if (UmiAtual > 94 || UmiAtual < 81) {
                            alerta.style.backgroundColor = '#ff0000 '
                            umi.innerHTML = `Umidade - Crítica`;
                        } else if (UmiAtual > 92 || UmiAtual < 83) {
                            alerta.style.backgroundColor = '#ffa500 '
                            umi.innerHTML = `Umidade - Emergência`;
                        } else if (UmiAtual > 90 || UmiAtual < 85) {
                            alerta.style.backgroundColor = '#ff0'
                            umi.innerHTML = `Umidade - Alerta`;
                        } else {
                            alerta.style.backgroundColor = '#00ff00 '
                            umi.innerHTML = `Umidade - Ideal`;
                        }

                        // incluir uma nova medida de umidade

                        // dados.datasets[0].data.shift(); 
                        // apagar o primeiro de temperatura
                        // dados.datasets[0].data.push(novoRegistro[0].temperatura);
                        // incluir uma nova medida de temperatura

                        myChart.update();
                    }

                    // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                    proximaAtualizacao = setTimeout(() => atualizarGrafico1(sector, dados, myChart), 2000);
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
                // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
                proximaAtualizacao = setTimeout(() => atualizarGrafico1(sector, dados, myChart), 2000);
            }
        })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });


        // grafico dois de umidade



    }







    // grafico 1 setor 1
    // const ctx = document.getElementById('myChartLinhaTemp1');

    // Chart.defaults.font.size = 16;
    // new Chart(ctx, {
    //     type: 'line',
    //     data: {
    //         labels: ['00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00', '07:00', '08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '.20:00', '21:00', '23:00'],
    //         datasets: [{
    //             label: 'Temperatura (°C)',
    //             data: vlrsGraficoTemp,
    //             backgroundColor: ('#00000000'),
    //             borderColor: ('#ff0000'),

    //         }]
    //     },
    // });


    // const ctx2 = document.getElementById('myChartLinhaTemp2');

    // Chart.defaults.font.size = 16;
    // new Chart(ctx2, {
    //     type: 'line',
    //     data: {
    //         labels: ['00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00', '07:00', '08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '.20:00', '21:00', '23:00'],
    //         datasets: [{
    //             label: 'Temperatura (°C)',
    //             data: vlrsGraficoTemp,
    //             backgroundColor: ('#00000000'),
    //             borderColor: ('#ff0000'),

    //         }]
    //     },
    // });




    // grafico 2
    // const ctx3 = document.getElementById('myChartLinhaUmi1');

    // new Chart(ctx3, {
    //     type: 'line',
    //     data: {
    //         labels: ['00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00', '07:00', '08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '.20:00', '21:00', '23:00'],
    //         datasets: [{
    //             label: 'Umidade (%)',
    //             data: vlrsGraficoUmi,
    //             backgroundColor: ('#00000000'),
    //             borderColor: ('#0000ff'),

    //             order: 0
    //         }]
    //     },
    //     options: {
    //         scales: {
    //             y: {
    //                 beginAtZero: true
    //             }
    //         }
    //     }
    // });


    // const ctx4 = document.getElementById('myChartLinhaUmi2');

    // new Chart(ctx4, {
    //     type: 'line',
    //     data: {
    //         labels: ['00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00', '07:00', '08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '.20:00', '21:00', '23:00'],
    //         datasets: [{
    //             label: 'Umidade (%)',
    //             data: vlrsGraficoUmi,
    //             backgroundColor: ('#00000000'),
    //             borderColor: ('#0000ff'),

    //             order: 0
    //         }]
    //     },
    //     options: {
    //         scales: {
    //             y: {
    //                 beginAtZero: true
    //             }
    //         }
    //     }
    // });

    // const ctx5 = document.getElementById('myChartdoughnutTemp1');

    // Chart.defaults.font.size = 16;
    // new Chart(ctx5, {
    //     type: 'doughnut',
    //     data: {
    //         labels: ['%Ideal', '%Alerta', '%Emergencial', '%Não Ideal',],
    //         datasets: [{
    //             label: 'Temperatura (%)',
    //             data: [70, 10, 10, 10],
    //             backgroundColor: [
    //                 '#00e600',
    //                 '#ffff00',
    //                 '#ff9900',
    //                 '#ff0000',

    //             ]

    //         }]
    //     },
    // });

    // const ctx6 = document.getElementById('myChartdoughnutTemp2');

    // Chart.defaults.font.size = 16;
    // new Chart(ctx6, {
    //     type: 'doughnut',
    //     data: {
    //         labels: ['%Ideal', '%Alerta', '%Emergencial', '%Não Ideal',],
    //         datasets: [{
    //             label: 'Temperatura (%)',
    //             data: [70, 10, 10, 10],
    //             backgroundColor: [
    //                 '#00e600',
    //                 '#ffff00',
    //                 '#ff9900',
    //                 '#ff0000',

    //             ]

    //         }]
    //     },
    // });

    // const ctx7 = document.getElementById('myChartdoughnutUmi1');

    // Chart.defaults.font.size = 16;
    // new Chart(ctx7, {
    //     type: 'doughnut',
    //     data: {
    //         labels: ['%Ideal', '%Alerta', '%Emergencial', '%Não Ideal',],
    //         datasets: [{
    //             label: 'Umidade (%)',
    //             data: [70, 10, 10, 10],
    //             backgroundColor: [
    //                 '#00e600',
    //                 '#ffff00',
    //                 '#ff9900',
    //                 '#ff0000',

    //             ]

    //         }]
    //     },
    // });

    // const ctx8 = document.getElementById('myChartdoughnutUmi2');

    // Chart.defaults.font.size = 16;
    // new Chart(ctx8, {
    //     type: 'doughnut',
    //     data: {
    //         labels: ['%Ideal', '%Alerta', '%Emergencial', '%Não Ideal',],
    //         datasets: [{
    //             label: 'Umidade (%)',
    //             data: [70, 10, 10, 10],
    //             backgroundColor: [
    //                 '#00e600',
    //                 '#ffff00',
    //                 '#ff9900',
    //                 '#ff0000',

    //             ]

    //         }]
    //     },
    // });



    // function obterDadosGrafico(sector) {

    //     // alterarTitulo(idAquario)

    //     // if (proximaAtualizacao != undefined) {
    //     //     clearTimeout(proximaAtualizacao);
    //     // }

    //     fetch(`/medidas/ultimas/${sector}`, { cache: 'no-store' }).then(function (response) {
    //         if (response.ok) {
    //             response.json().then(function (resposta) {
    //                 console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
    //                 resposta.reverse();

    //                 // plotarGrafico(resposta);

    //             });
    //         } else {
    //             console.error('Nenhum dado encontrado ou erro na API');
    //         }
    //     })
    //         .catch(function (error) {
    //             console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    //         });
    // }

    // plotando graficos

    // function plotarGrafico(resposta, idAquario) {

    //     console.log('iniciando plotagem do gráfico...');

    //     // Criando estrutura para plotar gráfico - labels
    //     let labels = [];

    //     // Criando estrutura para plotar gráfico - dados
    //     let dados = {
    //         labels: labels,
    //         datasets: [{
    //             label: 'Umidade',
    //             data: [],
    //             fill: false,
    //             borderColor: 'rgb(75, 192, 192)',
    //             tension: 0.1
    //         },
    //         {
    //             label: 'Temperatura',
    //             data: [],
    //             fill: false,
    //             borderColor: 'rgb(199, 52, 52)',
    //             tension: 0.1
    //         }]
    //     };
    // }



    // função


    // var divInfo = document.getElementById('divInforma');
    function setor() {
        sector = Number(slcSetor.value)
        if (sector == 2) {
            // var str = document.getElementById('str1');
            // var str2 = document.getElementById('str2');
            // var str3 = document.getElementById('str3');
            str1.style.display = 'none'
            str2.style.display = 'flex'
            // str3.style.display = 'none'
            // divInfo.style.display = 'flex'


            vlrsGraficoTemp = [16, 17, 20, 24, 29, 25]
            vlrsGraficoUmi = [80, 81, 85, 90, 92, 90]

            // ctx.update();
            // ctx2.update();

        }
        if (sector == 1) {
            // var str = document.getElementById('str1');
            // var str2 = document.getElementById('str2');
            // var str3 = document.getElementById('str3');

            str1.style.display = 'flex'
            str2.style.display = 'none'
            // str3.style.display = 'none'
            // divInfo.style.display = 'flex'

        }

    }

    var cadbar = document.getElementById('cadbar')

    function aparecerLogin() {

        var disP = cadbar.style.display

        if (disP == `flex`) { cadbar.style.display = "none" }
        else {
            cadbar.style.display = "flex"
            cadbar.style.primary.dim(on)
        }


    }

    function habilitar() {
        divMostrar
        var disP = divMostrar.style.display

        if (disP == `none`) {
            divMostrar.style.display = "flex"
            btnMostrar.style.display = "none"
        }
    }

    function confirmar() {

        faseCogu = slcFaseCogu.value
        var inpUmiMax = `${inp_umi_max.value}%`
        var inpTempMax = `${inp_temp_max.value}°C`
        var inpUmiMin = `${inp_umi_min.value}%`
        var inpTempMin = `${inp_temp_min.value}°C`




        if (inpTempMax == '°C') inpTempMax = vlr_Temp_max.innerHTML
        if (inpTempMin == '°C') inpTempMin = vlr_Temp_min.innerHTML
        if (inpUmiMax == '%') inpUmiMax = vlr_Umi_max.innerHTML
        if (inpUmiMin == '%') inpUmiMin = vlr_Umi_min.innerHTML


        if (sector == 1) {
            if (faseCogu == 1) {
                alert(`Fase mudada com sucesso`)

                vlr_Umi_min.innerHTML = `${inpUmiMin}`;
                vlr_Umi_max.innerHTML = `${inpUmiMax}`;
                vlr_Temp_min.innerHTML = `${inpTempMin}`;
                vlr_Temp_max.innerHTML = `${inpTempMax}`;

            } else if (faseCogu == 2) {

                alert(`Fase mudada com sucesso`)

                vlr_Umi_min.innerHTML = `${inpUmiMin}`;
                vlr_Umi_max.innerHTML = `${inpUmiMax}`;
                vlr_Temp_min.innerHTML = `${inpTempMin}`;
                vlr_Temp_max.innerHTML = `${inpTempMax}`;

            } else if (faseCogu == 3) {
                alert(`Fase mudada com sucesso`)

                vlr_Umi_min.innerHTML = `${inpUmiMin}`;
                vlr_Umi_max.innerHTML = `${inpUmiMax}`;
                vlr_Temp_min.innerHTML = `${inpTempMax}`;
                vlr_Temp_max.innerHTML = `${inpTempMin}`;

            } else {
                alert("Insira um fase para seu cogumelo!")
            }

        } else if (sector == 2) {
            if (faseCogu == 1) {
                alert(`Fase mudada com sucesso`)

                vlr_Umi_min.innerHTML = '82%';
                vlr_Umi_max.innerHTML = '90%';
                vlr_Temp_min.innerHTML = '15°C';
                vlr_Temp_max.innerHTML = '23°C';

            } else if (faseCogu == 2) {
                alert(`Fase mudada com sucesso`)

                vlr_Umi_min.innerHTML = '80%'
                vlr_Umi_max.innerHTML = '88%'
                vlr_Temp_min.innerHTML = '18°C';
                vlr_Temp_max.innerHTML = '25°C';

            } else if (faseCogu == 3) {
                alert(`Fase mudada com sucesso`)

                vlr_Umi_min.innerHTML = '83%';
                vlr_Umi_max.innerHTML = '89%';
                vlr_Temp_min.innerHTML = '17°C';
                vlr_Temp_max.innerHTML = ' 28°C';

            }

            else {
                alert("Insira um fase para seu cogumelo!")
            }
            divMostrar.style.display = "none"
            btnMostrar.style.display = "flex"



            if (vlrsGraficoTemp[vlrsGraficoTemp.length - 1] > TempMin + 4 && vlrsGraficoTemp[vlrsGraficoTemp.length - 1] < TempMax - 4) {
                temp.style.backgroundColor = '#29cf00'
            } else if (vlrsGraficoTemp[vlrsGraficoTemp.length - 1] < TempMin || vlrsGraficoTemp[vlrsGraficoTemp.length - 1] > TempMax) {
                temp.style.backgroundColor = '#ff0000'
            } else {
                temp.style.backgroundColor = '#ffff00'

            }

            if (vlrsGraficoUmi[vlrsGraficoUmi.length - 1] > umiMin + 5 && vlrsGraficoUmi[vlrsGraficoUmi.length - 1] < umiMax - 5) {
                temp.style.backgroundColor = '#29cf00'
            } else if (vlrsGraficoUmi[vlrsGraficoUmi.length - 1] < umiMin || vlrsGraficoUmi[vlrsGraficoUmi.length - 1] > umiMax) {
                temp.style.backgroundColor = '#ff0000'
            } else {
                temp.style.backgroundColor = '#ffff00'

            }
        } else if (sector == 1) {

        }
        else {
            alert(`As mudanças não foram feitas!! Revise os valores passados`)
        }

    }

    function mudarParametros() {

        num1 = Number(inpt_mudar.value)

        if (Parametros.length == 6) {

            Parametros.splice(1, 1)
            Parametros.push(num1);
            // addData(num1)
            // this.ctx5.update();
        }

    }

    function addData(newData) {

        // ctx5.dataset.data.push(Parametros);

    }

    setInterval(() => {

        // ctx5.update();
    }, 1000);




</script>